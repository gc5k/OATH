X[i,] = rbinom(n, 2, 0.5)
}
m=200
n=100
X=matrix(0, n, m)
for(i in 1:m) {
X[,i] = rbinom(n, 2, 0.5)
}
dim(X)
X=scale(X)
mean(X[,1])
var(X[,1])
y=rnorm(n)
G=X %*% t(X)/m
G[1:4, 1:4]
Q=t(y)%*%G%%*%y
Q=t(y)%*%G%*%y
dim(Q)
Q
m=200
n=100
X=matrix(0, n, m)
for(i in 1:m) {
X[,i] = rbinom(n, 2, 0.5)
}
sX=scale(X)
y=rnorm(n)
G=sX %*% t(sX)/m
Q=t(y)%*%G%*%y
dim(Q)
Q
W=sX%*%y
W=t(sX)%*%y
Q1=W^2/m
Q1
Q1=sum(W^2)/m
Q1
Q
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.5
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
h2E
betaSq
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
h2E
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.3
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.5
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.8
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
print(betaSq)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.5
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.5
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.5
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
r=0.8
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
r=seq(-0.9, 0.9, 0.1)
r
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
rr=seq(-0.9, 0.9, 0.1)
for(i in 1:length(rr)) {
r=rr[i]
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
rr=seq(-0.9, 0.9, 0.1)
for(i in 1:length(rr)) {
r=rr[i]
k=1
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E=(1+k*r)/(1+r^2)*betaSq
print(h2E)
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E)
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E)
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1.5
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1))
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(a=0.5)
abline(h=0.5)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=3
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.5
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.6
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.7
q1=1-p1
p2=0.5
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.7
q1=1-p1
p2=0.3
q2=1-p2
k=1
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
h2=0.5
p1=0.7
q1=1-p1
p2=0.3
q2=1-p2
k=2
rr=seq(-0.9, 0.9, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
rBound=sqrt(mim(p1,p2)/min(p1,p2)*min(q1,q2)/min(q2,q1))
rBound=sqrt(min(p1,p2)/min(p1,p2)*min(q1,q2)/min(q2,q1))
rBound
rBound=sqrt(min(p1,p2)/max(p1,p2)*min(q1,q2)/max(q2,q1))
rBound
h2=0.5
p1=0.7
q1=1-p1
p2=0.3
q2=1-p2
k=2
rBound=sqrt(min(p1,p2)/max(p1,p2)*min(q1,q2)/max(q2,q1))
rr=seq(-rBound, rBound, 0.1)
h2E=array(0, length(rr))
for(i in 1:length(rr)) {
r=rr[i]
betaSq=h2/(2*p1*q1+2*p2*q2*k^2+2*r*sqrt(2*p1*q1*2*p2*q2)*k)
#  print(betaSq)
h2E[i]=betaSq*((1+k*r)^2+(r+k)^2)/(1+r^2)
print(h2E[i])
}
plot(rr, h2E/2, ylim=c(0, 1), bty='l')
abline(h=0.5, lty=2)
shiny::runApp('git/OATH/OATHshiny')
runApp('git/OATH/OATHshiny')
